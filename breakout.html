<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-select=none">
<title>ğŸ§± æ‰“ç£šå¡Šï¼šé—œå¡é€²åŒ–ç‰ˆ</title>
    <div id="home-btn-container" onclick="window.location.href='index.html'">
    <svg viewBox="0 0 24 24" width="24" height="24">
        <path fill="currentColor" d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
    </svg>
    <span>å¤§å»³</span>
</div>
<style>
    :root {
        --neon-blue: #00ffff;
        --neon-pink: #ff00ff;
    }
    body {
        margin: 0; background: #0a0a12; color: white;
        text-align: center; font-family: 'Segoe UI', sans-serif;
        overflow: hidden; touch-action: none;
    }

    /* é ‚éƒ¨è³‡è¨Šæ¬„ */
    #header {
        display: flex; justify-content: space-around;
        padding: 15px; background: rgba(255,255,255,0.05);
        font-weight: bold; font-size: 1.1rem;
    }
    .stat span { color: var(--neon-blue); }

    /* éŠæˆ²å€åŸŸ */
    #canvas-container {
        position: relative; width: 95vw; max-width: 480px;
        aspect-ratio: 3/2; margin: 20px auto;
        border: 2px solid var(--neon-blue); border-radius: 10px;
        box-shadow: 0 0 15px rgba(0, 255, 255, 0.2);
    }
    canvas { width: 100%; height: 100%; display: block; background: #000; }

    /* æ§åˆ¶èªªæ˜ */
    .hint { color: #666; font-size: 0.8rem; margin-bottom: 10px; }
#home-btn-container {
        position: fixed;
        top: 15px;
        left: 15px;
        z-index: 9999; /* ç¢ºä¿åœ¨æ‰€æœ‰éŠæˆ²å…ƒç´ ä¹‹ä¸Š */
        display: flex;
        align-items: center;
        gap: 5px;
        padding: 8px 15px;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(8px);
        border: 1px solid rgba(0, 242, 254, 0.5);
        border-radius: 50px;
        color: #00f2fe;
        cursor: pointer;
        font-family: 'Segoe UI', sans-serif;
        font-weight: bold;
        font-size: 14px;
        box-shadow: 0 0 15px rgba(0, 242, 254, 0.2);
        transition: 0.3s;
        user-select: none;
    }

    #home-btn-container:hover {
        background: rgba(0, 242, 254, 0.2);
        box-shadow: 0 0 20px rgba(0, 242, 254, 0.5);
        transform: scale(1.05);
    }

    #home-btn-container:active {
        transform: scale(0.95);
    }

    /* æ‰‹æ©Ÿç‰ˆå¾®èª¿ï¼šå¦‚æœè¦ºå¾—å¤ªå¤§å¯ä»¥ç¸®å°ä¸€é» */
    @media (max-width: 480px) {
        #home-btn-container {
            top: 10px;
            left: 10px;
            padding: 6px 12px;
            font-size: 12px;
        }
    }
    /* æŒ‰éˆ•æ¨£å¼ */
    button {
        padding: 12px 24px; font-size: 1rem; border-radius: 30px;
        border: 1px solid var(--neon-blue); background: transparent;
        color: var(--neon-blue); cursor: pointer; transition: 0.3s;
    }
    button:active { background: var(--neon-blue); color: #000; }
</style>
</head>
<body>

<div id="header">
    <div class="stat">é—œå¡: <span id="lv-txt">1</span></div>
    <div class="stat">åˆ†æ•¸: <span id="score-txt">0</span></div>
</div>

<div id="canvas-container">
    <canvas id="game" width="480" height="320"></canvas>
</div>

<p class="hint">é›»è…¦ï¼šæ»‘é¼ ç§»å‹•æˆ–å·¦å³éµ | æ‰‹æ©Ÿï¼šç›´æ¥æ»‘å‹•è¢å¹•</p>
<button onclick="resetGame(true)">é‡ç½®éŠæˆ²</button>



<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// éŠæˆ²è®Šæ•¸
let level = 1;
let score = 0;
let x, y, dx, dy;
let ballRadius = 8;
let paddleHeight = 12;
let paddleWidth = 90;
let paddleX;
let rightPressed = false;
let leftPressed = false;

// ç£šå¡Šé…ç½®
const brickPadding = 10;
const brickOffsetTop = 30;
const brickOffsetLeft = 25;
let bricks = [];
let rowCount = 3;
let colCount = 5;

function initLevel() {
    // æ ¹æ“šé—œå¡èª¿æ•´é›£åº¦
    rowCount = 2 + level; // æ¯é—œå¤šä¸€è¡Œ
    colCount = 6;
    
    // åˆå§‹ä½ç½®
    x = canvas.width / 2;
    y = canvas.height - 40;
    
    // çƒé€Ÿéš¨é—œå¡ç•¥å¾®æå‡
    let speed = 2 + (level * 0.5);
    dx = speed;
    dy = -speed;
    
    paddleX = (canvas.width - paddleWidth) / 2;

    // åˆå§‹åŒ–ç£šå¡Š
    bricks = [];
    for (let c = 0; c < colCount; c++) {
        bricks[c] = [];
        for (let r = 0; r < rowCount; r++) {
            bricks[c][r] = { x: 0, y: 0, status: 1, color: `hsl(${(r * 40) + (level * 20)}, 70%, 60%)` };
        }
    }
    updateUI();
}

// --- æ§åˆ¶é‚è¼¯ ---
document.addEventListener("keydown", e => {
    if (e.key === "ArrowRight") rightPressed = true;
    if (e.key === "ArrowLeft") leftPressed = true;
});
document.addEventListener("keyup", e => {
    if (e.key === "ArrowRight") rightPressed = false;
    if (e.key === "ArrowLeft") leftPressed = false;
});

// æ»‘é¼ èˆ‡è§¸æ§çµ±ä¸€é‚è¼¯
function handleMove(e) {
    e.preventDefault();
    const rect = canvas.getBoundingClientRect();
    let clientX = e.touches ? e.touches[0].clientX : e.clientX;
    const relativeX = (clientX - rect.left) * (canvas.width / rect.width);
    
    if (relativeX > 0 && relativeX < canvas.width) {
        paddleX = relativeX - paddleWidth / 2;
    }
}
canvas.addEventListener("mousemove", handleMove);
canvas.addEventListener("touchmove", handleMove, { passive: false });

// --- ç¢°æ’æª¢æ¸¬ ---
function collisionDetection() {
    for (let c = 0; c < colCount; c++) {
        for (let r = 0; r < rowCount; r++) {
            const b = bricks[c][r];
            if (b.status === 1) {
                // è¨ˆç®—ç£šå¡Šå¯¬åº¦ä»¥å¡«æ»¿ç•«é¢
                const bw = (canvas.width - (brickOffsetLeft * 2) - (colCount - 1) * brickPadding) / colCount;
                const bh = 18;
                const bx = c * (bw + brickPadding) + brickOffsetLeft;
                const by = r * (bh + brickPadding) + brickOffsetTop;
                b.x = bx; b.y = by;

                if (x > bx && x < bx + bw && y > by && y < by + bh) {
                    dy = -dy;
                    b.status = 0;
                    score += 10;
                    updateUI();

                    // æª¢æŸ¥éé—œ
                    if (checkWin()) {
                        level++;
                        alert(`ğŸŒŸ é—œå¡ ${level-1} å®Œæˆï¼æº–å‚™é€²å…¥é—œå¡ ${level}`);
                        initLevel();
                    }
                }
            }
        }
    }
}

function checkWin() {
    for(let c=0; c<colCount; c++) {
        for(let r=0; r<rowCount; r++) {
            if(bricks[c][r].status === 1) return false;
        }
    }
    return true;
}

// --- ç¹ªè£½å‡½æ•¸ ---
function drawBall() {
    ctx.beginPath();
    ctx.arc(x, y, ballRadius, 0, Math.PI * 2);
    ctx.fillStyle = "#fff";
    ctx.fill();
    ctx.closePath();
}

function drawPaddle() {
    ctx.beginPath();
    ctx.roundRect(paddleX, canvas.height - paddleHeight - 5, paddleWidth, paddleHeight, 5);
    ctx.fillStyle = "#00ffff";
    ctx.fill();
    ctx.closePath();
}

function drawBricks() {
    const bw = (canvas.width - (brickOffsetLeft * 2) - (colCount - 1) * brickPadding) / colCount;
    const bh = 18;
    for (let c = 0; c < colCount; c++) {
        for (let r = 0; r < rowCount; r++) {
            if (bricks[c][r].status === 1) {
                ctx.beginPath();
                ctx.roundRect(bricks[c][r].x, bricks[c][r].y, bw, bh, 3);
                ctx.fillStyle = bricks[c][r].color;
                ctx.fill();
                ctx.closePath();
            }
        }
    }
}

function updateUI() {
    document.getElementById("lv-txt").innerText = level;
    document.getElementById("score-txt").innerText = score;
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBricks();
    drawBall();
    drawPaddle();
    collisionDetection();

    // ç‰†å£ç¢°æ’
    if (x + dx > canvas.width - ballRadius || x + dx < ballRadius) dx = -dx;
    if (y + dy < ballRadius) dy = -dy;
    else if (y + dy > canvas.height - ballRadius - 5) {
        if (x > paddleX && x < paddleX + paddleWidth) {
            // æ ¹æ“šæ’æ“Šæ“‹æ¿çš„ä½ç½®æ”¹è®Šçƒçš„åå°„è§’åº¦
            let hitPos = (x - (paddleX + paddleWidth/2)) / (paddleWidth/2);
            dx = hitPos * 3;
            dy = -dy;
        } else {
            alert("ğŸ’€ éŠæˆ²çµæŸï¼ä½ çš„åˆ†æ•¸: " + score);
            resetGame(true);
            return;
        }
    }

    // æ“‹æ¿ç§»å‹•
    if (rightPressed && paddleX < canvas.width - paddleWidth) paddleX += 7;
    if (leftPressed && paddleX > 0) paddleX -= 7;

    x += dx;
    y += dy;
    requestAnimationFrame(draw);
}

function resetGame(fullReset) {
    if (fullReset) {
        level = 1;
        score = 0;
    }
    initLevel();
}

// å•Ÿå‹•
initLevel();
draw();

</script>
</body>
</html>

